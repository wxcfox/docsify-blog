------



# 一 备战面试

> 作者：小白。
>
> **介绍:** xxx

hello

## 1.1 进程、线程、协程

### 1.1.1 进程间通信方式

a. 管道模型（匿名管道、命名管道）：

管道：管道实质是内核中的一块内存缓存区。创建缓存后会返回两个文件描述符，分别是读与写。有名管道可以在不存在亲缘关系的进程中通信。管道的缺点：只能FIFO、数据无格式且大小受限、并且通信方式是单向的，若需要双向则需要建立两个通道。

b. 消息队列模型

消息队列：消息队列是内核中的消息链，消息队列支持消息的随机查询，且能够实现多个进程间的读写操作。消息队列相比管道能承载更多的消息。但是消息队列与管道一样，都存在内核与用户内存间的数据拷贝，因此不适合进行频繁的通信。消息队列生命周期随内核，如果没有释放消息队列或者没有关闭操作系统，消息队列会一直存在。

c. 共享内存+信号量

共享内存：两个进程拿出一块虚拟地址空间来，映射到相同的物理内存中，共享内存不再需要用户到内核的数据拷贝，通信双方直接操作用户空间的共享内存即可完成通信。
信号量：为了防止多进程竞争共享资源，而造成的数据错乱，所以需要保护机制，使得共享的资源，在任意时刻只能被一个进程访问。正好，信号量就实现了这一保护机制。信号量其实是一个整型的计数器，主要用于实现进程间的互斥与同步，而不是用于缓存进程间通信的数据。信号量表示资源的数量，控制信号量的方式有两种原子操作：
一个是 P 操作，这个操作会把信号量减去 -1，相减后如果信号量 < 0，则表明资源已被占用，进程需阻塞等待；相减后如果信号量 >= 0，则表明还有资源可使用，进程可正常继续执行。
另一个是 V 操作，这个操作会把信号量加上 1，相加后如果信号量 <= 0，则表明当前有阻塞中的进程，于是会将该进程唤醒运行；相加后如果信号量 > 0，则表明当前没有阻塞中的进程；
P 操作是用在进入共享资源之前，V 操作是用在离开共享资源之后，这两个操作是必须成对出现的。
信号初始化为 1，就代表着是互斥信号量，它可以保证共享内存在任何时刻只有一个进程在访问，这就很好的保护了共享内存。
信号初始化为 0，就代表着是同步信号量，它可以保证进程 A 应在进程 B 之前执行。

<img src="pictures/互斥信号量.png" width="200" height="200"/>
<img src="pictures/同步信号量.png" width="200" height="200"/>

d. 信号

信号：是事件发生对进程的通知机制，它是软件层次上对中断机制的一种模式，是进程间通信机制中唯一的异步通信机制。对于异常情况下的工作模式，就需要用信号的方式来通知进程。信号可以导致一个正在运行的进程被另一个正在运行的异步进程中断,转而处理某一个突发事件。信号事件的来源主要有硬件来源（如键盘 Cltr+C ）和软件来源（如 kill 命令）
因为可以在任何时候发送信号给某一进程，一旦有信号产生，我们就有下面这几种，用户进程对信号的处理方式：
执行默认操作：Linux 对每种信号都规定了默认操作，例如，上面列表中的 SIGTERM 信号，就是终止进程的意思。Core 的意思是 Core Dump，也即终止进程后，通过 Core Dump 将当前进程的运行状态保存在文件里面，方便程序员事后进行分析问题在哪里。
捕捉信号：我们可以为信号定义一个信号处理函数。当信号发生时，我们就执行相应的信号处理函数。
忽略信号：当我们不希望处理某些信号的时候，就可以忽略该信号，不做任何处理。有两个信号是应用进程无法捕捉和忽略的，即 SIGKILL 和 SEGSTOP，它们用于在任何时候中断或结束某一进程。

e. socket

socket：前面说到的通信机制，都是工作于同一台主机，如果要与不同主机的进程间通信，那么就需要 Socket 通信了。Socket 实际上不仅用于不同的主机进程间通信，还可以用于本地主机进程间通信，可根据创建 Socket 的类型不同，分为三种常见的通信方式，一个是基于 TCP 协议的通信方式，一个是基于 UDP 协议的通信方式，一个是本地进程间通信方式。

参考： https://www.cnblogs.com/xiaolincoding/p/13402297.html
